Kiểm tra source code  

![image](https://user-images.githubusercontent.com/125866921/227217702-589104af-4767-4f7f-97dd-596a9333d90c.png)

Ta thấy dev đã không còn biến $extension để check file. Thay vào đó ở line thứ 18, sẽ check MINE type của file được upload.Nếu Mine type đó có tồn tại trong mảng image/jpeg", "image/png", "image/gif" thì upload file thành công  

Vậy khi ta upload một file bất kì thì lên web thì 1 MINE type tương ứng sẽ được kèm theo file đó. Ví dụ những file image thì thường có MINE type là image/jpeg, image/png, image/gif.  

Khi upload một file php thì MINE type của file ấy là application/x-httpd-php. Như vậy sẽ fail vì khác với MINE type của đề bài  

Như vậy ta cần sử dụng tool Burp Suite để thay đổi giá trị của phần Content-Type trong gói tin HTTP.  

Đầu tiên upload một file .php với hàm system() sau đó thay đổi giá trị của Content-Type giống với MINE type của src code.  

![image](https://user-images.githubusercontent.com/125866921/227217827-635fbfa3-e39f-4d37-8a25-2c3063b4826e.png)

Và ta đã thấy được file có chứa flag ở secret.txt.Dùng lệnh cat là đọc được.
