Check source code của level 4  

![image](https://user-images.githubusercontent.com/125866921/227216610-eef32c9c-d67d-4d58-8be0-014b3336fd09.png)

Ở line 20, filter 3 đuôi .phar, .phtml và .php bằng cách sử dụng hàm in_array()  

Vậy thì nếu biến $extension có giá trị nằm trong 3 đuôi trên thì bị chặn.  

Nhưng challenge lần này dev đã cho thêm 1 file apache2. Mở file apache2  

![image](https://user-images.githubusercontent.com/125866921/227216735-2d264f3a-c088-4d5a-abd8-7b54b5b44605.png)

Bắt đầu phân tích từ line 35 đến line 40. Ta thấy Apache này cho phép ta upload file .htaccess để ghi đè. Các file htaccess là file cấu hình thư mục hiện tại. Ta còn có thể add thêm extension và cho nó thực thi theo loại file ta muốn.  

![image](https://user-images.githubusercontent.com/125866921/227217066-678db507-7d03-4eb6-82d5-379a43d2ccf7.png)

Lúc này tất cả các file có đuôi là hack sẽ được execute dưới dạng file php  

Vậy ta sẽ upload file htaccess với content như trên:  

![image](https://user-images.githubusercontent.com/125866921/227217175-eb79736a-bff5-4086-9b01-cbe3bc485280.png)

Kế đó upload file debug.hack với hàm system() để đọc flag  

![image](https://user-images.githubusercontent.com/125866921/227217250-5ba6d915-f490-4555-844d-eb6c6c9815c9.png)
