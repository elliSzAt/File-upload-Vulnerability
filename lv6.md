Check source code  

![image](https://user-images.githubusercontent.com/125866921/227218090-d5f1823a-819b-407e-9c9b-494a44d56b79.png)

Đầu tiên là sever vẫn check MINE type của file  

Kế đó là mình thấy line thứ 14 và 15 có $finfo cùng với đó là biến finfo_open() là mới khác với các level trước. Sau khi research thì mình biết là hàm finfo_open() với tham số DILEINFO_MINE_TYPE để lấy ra magic_database  

Ở line thứ 15 có hàm finfo_file() sẽ kiểm tra MINE type từ magic byte của file được upload và gán vào biến $mine_type  

Line kế tiếp có biến $whitelist gồm image/jpeg, image/png, image/gif. Theo những gì mình nói ở Readme có một lỗ hổng là whitelist- là những danh sách file cho phép được tải lên  

Vậy ở dòng tiếp theo, nếu $mine_type xuất hiện trong $whitelist thì upload sẽ thành công.  

Kết luận là theo cách sever xử lý ở trên, để có thể bypass được filter thì cần phải thay đổi magic byte phù hợp với kiểu file image.  

Mình sẽ dùng magic bytes của file GIF để chèn vào đầu file.  

![image](https://user-images.githubusercontent.com/125866921/227218195-53b34bec-7471-4362-b272-e784d6aa3518.png)

Sau đó upload file và thực hiện lệnh cat để nhận flag.  
